<!-- markdownlint-disable MD002 MD041 -->

この演習では、Azure Active Directory 管理センターを使用AD新しい Azure AD Web アプリケーションの登録を作成します。

1. ブラウザーを開き、[Azure Active Directory 管理センター](https://aad.portal.azure.com)へ移動します。 **個人用アカウント** (別名: Microsoft アカウント)、または **職場/学校アカウント** を使用してログインします。

1. 左側のナビゲーションで **[Azure Active Directory]** を選択し、それから **[管理]** で **[アプリの登録]** を選択します。

    ![アプリの登録のスクリーンショット ](./images/aad-portal-app-registrations.png)

1. **[新規登録]** を選択します。 [ **アプリケーションの登録]** ページで、前のセクションでコピーした ngrok 転送 URL を次のように `YOUR_NGROK_URL` 設定します。

    - `Teams Graph Tutorial` に **[名前]** を設定します。
    - **[サポートされているアカウントの種類]** を **[任意の組織のディレクトリ内のアカウントと個人用の Microsoft アカウント]** に設定します。
    - **[リダイレクト URI]** で、最初のドロップダウン リストを `Web` に設定し、それから `YOUR_NGROK_URL/authcomplete` に値を設定します。

    ![[アプリケーションを登録する] ページのスクリーンショット](./images/aad-register-an-app.png)

1. **[登録]** を選択します。 **[Teams Graph チュートリアル**] ページで、アプリケーション **(クライアント) ID** の値をコピーして保存します。次の手順で必要になります。

    ![新しいアプリ登録のアプリケーション ID のスクリーンショット](./images/aad-application-id.png)

1. **[管理]** の下の **[認証]** を選択します。 暗黙的な許可 **セクションを見つけて**、アクセス トークンと ID **トークン****を有効にします**。 **[保存]** を選択します。

1. **[管理]** で **[証明書とシークレット]** を選択します。 
            **[新しいクライアント シークレット]** ボタンを選択します。 **[説明]** に値を入力して、**[有効期限]** のオプションのいずれかを選び、**[追加]** を選択します。

1. クライアント シークレットの値をコピーしてから、このページから移動します。 次の手順で行います。

    > [!IMPORTANT]
    > このクライアント シークレットは今後表示されないため、今必ずコピーするようにしてください。

1. [管理 **] で [API のアクセス** 許可 **] を選択し**、[アクセス許可の **追加] を選択します**。

1. **[Microsoft Graph] を選択** し、[**委任されたアクセス許可] を選択します**。

1. 次のアクセス許可を選択し、[アクセス許可の追加 **] を選択します**。

    - **Calendars.ReadWrite** - これにより、アプリはユーザーの予定表を読み書きできます。
    - **MailboxSettings.Read** - これにより、アプリはメールボックス設定からユーザーのタイム ゾーン、日付形式、時刻形式を取得できます。

    ![構成されているアクセス許可のスクリーンショット](images/aad-configured-permissions.png)

## <a name="configure-teams-single-sign-on"></a>Teams シングル サインオンを構成する

このセクションでは、Teams でのシングル サインオンをサポートするためにアプリ [の登録を更新します](/microsoftteams/platform/tabs/how-to/authentication/auth-aad-sso)。

1. [API **の公開] を選択します**。 [アプリケーション ID **URI]** の横にある [ **設定] リンクを選択します**。 二重スラッシュと GUID の間に ngrok 転送 URL ドメイン名 (末尾にスラッシュ "/" が付加された名前) を挿入します。 ID 全体は次のように表示されます `api://50153897dd4d.ngrok.io/ae7d8088-3422-4c8c-a351-6ded0f21d615` 。

1. [この **API で定義されているスコープ** ] セクションで、[スコープの追加 **] を選択します**。 フィールドに次のように入力し、[範囲の追加 **] を選択します**。

    - **スコープ名:**`access_as_user`
    - **同意できるユーザー: 管理者とユーザー**
    - **管理者の同意の表示名:**`Access the app as the user`
    - **管理者の同意の説明:**`Allows Teams to call the app's web APIs as the current user.`
    - **ユーザーの同意の表示名:**`Access the app as you`
    - **ユーザーの同意の説明:**`Allows Teams to call the app's web APIs as you.`
    - **状態: 有効**

    ![[範囲の追加] フォームのスクリーンショット](images/aad-add-scope.png)

1. [承認済み **クライアント アプリケーション] セクションで** 、[クライアント アプリケーションの **追加] を選択します**。 次の一覧からクライアント ID を入力し、[承認済みスコープ] の下のスコープを有効にして、[アプリケーションの追加]**を選択します**。 リスト内の各クライアント ID に対してこのプロセスを繰り返します。

    - `1fec8e78-bce4-4aaf-ab1b-5451cc387264` (Teams モバイル/デスクトップ アプリケーション)
    - `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` (Teams Web アプリケーション)
